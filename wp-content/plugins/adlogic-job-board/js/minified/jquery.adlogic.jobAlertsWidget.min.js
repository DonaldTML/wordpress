adlogicJobSearch.registered_job_alert_widgets=[],function(e){e.fn.extend({adlogicJobAlertsWidget:function(t){var o,a,i={widgetId:"",dropdownType:{locations:"single",classifications:"single",worktypes:"single"},topLevelOnly:{locations:!1,classifications:!1,worktypes:!1},hideEmpty:{locations:!1,classifications:!1,worktypes:!1}},t=e.extend(i,t),n={},s={init:function(t){o=this;var t=e.extend(i,t);return e.each(adlogicJobSearch.registered_job_alert_widgets,function(e,t){t==this&&(a=!0)}),1==a?!1:(e(document).trigger("adlogicJobSearch.jobAlertsWidget.init",[o,t]),adlogicJobSearch.registered_job_alert_widgets=adlogicJobSearch.registered_job_alert_widgets.concat(this),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").attr("disabled",!0),void(0==e.active?(s.buildDropdowns.apply(o),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").click(function(){return s.subscribe.apply(o)}),e("#"+t.widgetId+" form").submit(function(){return s.subscribe.apply(o)}),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").attr("disabled",!1),e(document).unbind("ajaxStop")):e(document).ajaxStop(function(){s.buildDropdowns.apply(o),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").click(function(){return s.subscribe.apply(o)}),e("#"+t.widgetId+" form").submit(function(){return s.subscribe.apply(o)}),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").attr("disabled",!1),e(document).unbind("ajaxStop")})))},buildDropdowns:function(){"undefined"==typeof adlogicJobSearch.cache&&(adlogicJobSearch.cache={}),e("#"+t.widgetId+"-classification_id").length>0&&(e("#"+t.widgetId+"-classification_id").prev("label").toggleClass("loading"),getClassificationsUrl=adlogicJobSearch.ajaxurl+"?action=getIndustries",1==t.topLevelOnly.classifications&&(getClassificationsUrl+="&onlyFirstLevel=true"),1==t.hideEmpty.classifications&&(getClassificationsUrl+="&jobCount=true"),"undefined"==typeof adlogicJobSearch.cache.classifications||"undefined"==typeof adlogicJobSearch.cache.classificationsUrl&&(1==t.adCounts.classifications||1==t.hideEmpty.classifications)||"undefined"!=typeof adlogicJobSearch.cache.classificationsUrl&&getClassificationsUrl!=adlogicJobSearch.cache.classificationsUrl?e.ajax(getClassificationsUrl,{success:function(a){adlogicJobSearch.cache.classificationsUrl=getClassificationsUrl,adlogicJobSearch.cache.classificationDataArray=new Array,adlogicJobSearch.cache.classifications=a.cla,e.each(a.cla,function(t){classificationType=e(this)[0],"0"==classificationType.parent||"undefined"==typeof classificationType.parent?(ad_count="undefined"==typeof classificationType.adCount?!1:classificationType.adCount,adlogicJobSearch.cache.classificationDataArray.push({id:classificationType.id,label:classificationType.displayName,count:ad_count,children:[]})):e.each(adlogicJobSearch.cache.classificationDataArray,function(t,o){ad_count="undefined"==typeof classificationType.adCount?!1:classificationType.adCount,o.id==classificationType.parent?o.children.push({id:classificationType.id,label:classificationType.displayName,count:ad_count,children:[]}):o.children.length>0&&e.each(o.children,function(e,t){t.id==classificationType.parent&&t.children.push({id:classificationType.id,label:classificationType.displayName,count:ad_count,children:[]})})})}),dropdownOptions=[{select:e("#"+t.widgetId+"-classification_id"),data:adlogicJobSearch.cache.classificationDataArray,type:"classification"}],s.renderDropdowns.apply(o,dropdownOptions)},statusCode:{500:function(){"undefined"==typeof this.retries&&(this.retries=0),this.retries++,n.classifications=this,this.retries<=5&&setTimeout(function(){e.ajax(n.classifications)},1e3*this.retries)},503:function(){"undefined"==typeof this.retries&&(this.retries=0),this.retries++,n.classifications=this,this.retries<=5&&setTimeout(function(){e.ajax(n.classifications)},1e3*this.retries)}}}):(dropdownOptions=[{select:e("#"+t.widgetId+"-classification_id"),data:adlogicJobSearch.cache.classificationDataArray,type:"classification"}],s.renderDropdowns.apply(o,dropdownOptions))),e("#"+t.widgetId+"-location_id").length>0&&(e("#"+t.widgetId+"-location_id").prev("label").toggleClass("loading"),getLocationsUrl=adlogicJobSearch.ajaxurl+"?action=getLocations",1==t.topLevelOnly.locations&&(getLocationsUrl+="&onlyFirstLevel=true"),1==t.hideEmpty.locations&&(getLocationsUrl+="&jobCount=true"),"undefined"==typeof adlogicJobSearch.cache.locations||"undefined"==typeof adlogicJobSearch.cache.locationsUrl&&(1==t.adCounts.locations||1==t.hideEmpty.locations)||"undefined"!=typeof adlogicJobSearch.cache.locationsUrl&&getLocationsUrl!=adlogicJobSearch.cache.locationsUrl?e.ajax(getLocationsUrl,{success:function(a){adlogicJobSearch.cache.locationsUrl=getLocationsUrl,adlogicJobSearch.cache.locationDataArray=new Array,adlogicJobSearch.cache.locations=a.loc;e.each(a.loc,function(t){locationType=e(this)[0],"0"==locationType.parent||"undefined"==typeof locationType.parent?(ad_count="undefined"==typeof locationType.adCount?!1:locationType.adCount,adlogicJobSearch.cache.locationDataArray.push({id:locationType.id,label:locationType.displayName,count:ad_count,children:[]})):e.each(adlogicJobSearch.cache.locationDataArray,function(t,o){ad_count="undefined"==typeof locationType.adCount?!1:locationType.adCount,o.id==locationType.parent?o.children.push({id:locationType.id,label:locationType.displayName,count:ad_count,children:[]}):o.children.length>0&&e.each(o.children,function(e,t){t.id==locationType.parent&&t.children.push({id:locationType.id,label:locationType.displayName,count:ad_count,children:[]})})})}),dropdownOptions=[{select:e("#"+t.widgetId+"-location_id"),data:adlogicJobSearch.cache.locationDataArray,type:"location"}],s.renderDropdowns.apply(o,dropdownOptions)},statusCode:{500:function(){"undefined"==typeof this.retries&&(this.retries=0),this.retries++,n.locations=this,this.retries<=5&&setTimeout(function(){e.ajax(n.locations)},1e3*this.retries)},503:function(){"undefined"==typeof this.retries&&(this.retries=0),this.retries++,n.locations=this,this.retries<=5&&setTimeout(function(){e.ajax(n.locations)},1e3*this.retries)}}}):(dropdownOptions=[{select:e("#"+t.widgetId+"-location_id"),data:adlogicJobSearch.cache.locationDataArray,type:"location"}],s.renderDropdowns.apply(o,dropdownOptions))),e("#"+t.widgetId+"-worktype_id").length>0&&(e("#"+t.widgetId+"-worktype_id").prev("label").toggleClass("loading"),getWorktypesUrl=adlogicJobSearch.ajaxurl+"?action=getWorktypes",1==t.topLevelOnly.worktypes&&(getWorktypesUrl+="&onlyFirstLevel=true"),1==t.hideEmpty.worktypes&&(getWorktypesUrl+="&jobCount=true"),"undefined"==typeof adlogicJobSearch.cache.worktypes||"undefined"==typeof adlogicJobSearch.cache.worktypesUrl&&(1==t.adCounts.worktypes||1==t.hideEmpty.worktypes)||"undefined"!=typeof adlogicJobSearch.cache.worktypesUrl&&getWorktypesUrl!=adlogicJobSearch.cache.worktypesUrl?e.ajax(getWorktypesUrl,{success:function(a){adlogicJobSearch.cache.worktypesUrl=getWorktypesUrl,adlogicJobSearch.cache.worktypeDataArray=new Array,adlogicJobSearch.cache.worktypes=a.wor,e.isArray(a.wor)||(a.wor=new Array(a.wor)),e.each(a.wor,function(t){worktypeType=e(this)[0],"0"==worktypeType.parent?(ad_count="undefined"==typeof worktypeType.adCount?!1:worktypeType.adCount,adlogicJobSearch.cache.worktypeDataArray.push({id:worktypeType.id,label:worktypeType.displayName,count:ad_count,children:[]})):e.each(adlogicJobSearch.cache.worktypeDataArray,function(e,t){ad_count="undefined"==typeof worktypeType.adCount?!1:worktypeType.adCount,t.id==worktypeType.parent&&t.children.push({id:worktypeType.id,label:worktypeType.displayName,count:ad_count})})}),dropdownOptions=[{select:e("#"+t.widgetId+"-worktype_id"),data:adlogicJobSearch.cache.worktypeDataArray,type:"worktype"}],s.renderDropdowns.apply(o,dropdownOptions)},statusCode:{500:function(){"undefined"==typeof this.retries&&(this.retries=0),this.retries++,n.worktypes=this,this.retries<=5&&setTimeout(function(){e.ajax(n.worktypes)},1e3*this.retries)},503:function(){"undefined"==typeof this.retries&&(this.retries=0),this.retries++,n.worktypes=this,this.retries<=5&&setTimeout(function(){e.ajax(n.worktypes)},1e3*this.retries)}}}):(dropdownOptions=[{select:e("#"+t.widgetId+"-worktype_id"),data:adlogicJobSearch.cache.worktypeDataArray,type:"worktype"}],s.renderDropdowns.apply(o,dropdownOptions)))},renderDropdowns:function(a){switch(a.type){case"classification":selectOptions={dropdownType:t.dropdownType.classifications,rawcache:adlogicJobSearch.cache.classifications,hideEmpty:t.hideEmpty.classifications,doubleSelectId:"#"+t.widgetId+"-classification_select_id",subSelectId:"#"+t.widgetId+"-sub_classification_select_id",translation:t.translations.classifications,sub_translation:t.translations.sub_classifications,selectedValue:"undefined"!=typeof indIdDef?indIdDef:null};break;case"location":selectOptions={dropdownType:t.dropdownType.locations,rawcache:adlogicJobSearch.cache.locations,hideEmpty:t.hideEmpty.locations,doubleSelectId:"#"+t.widgetId+"-location_select_id",subSelectId:"#"+t.widgetId+"-sub_location_select_id",translation:t.translations.locations,sub_translation:t.translations.sub_locations,selectedValue:"undefined"!=typeof locIdDef?locIdDef:null};break;case"worktype":selectOptions={dropdownType:"flat",rawcache:adlogicJobSearch.cache.worktypes,translation:t.translations.worktype,hideEmpty:t.hideEmpty.worktypes,doubleSelectId:null,subSelectId:null,sub_translation:"",selectedValue:"undefined"!=typeof wtIdDef?wtIdDef:null}}switch(selectOptions.dropdownType){case"single":case"multiple":a.select.append('<option value="">All '+selectOptions.translation+"</option>"),e.each(a.data,function(t,o){return 1==selectOptions.hideEmpty&&0==o.count?!0:(optionEl=e('<option value="'+o.id+'" class="ajb-parent-opt"><strong>'+o.label+"</strong></option>"),a.select.append(optionEl),void e.each(o.children,function(t,o){return 1==selectOptions.hideEmpty&&0==o.count?!0:(1==selectOptions.adCounts?o.children.length>0?a.select.append('<option value="'+o.id+'" class="ajb-sub-parent-opt">&nbsp;&nbsp;&nbsp;'+o.label+" ("+o.count+")</option>"):a.select.append('<option value="'+o.id+'">&nbsp;&nbsp;&nbsp;'+o.label+" ("+o.count+")</option>"):o.children.length>0?a.select.append('<option value="'+o.id+'" class="ajb-sub-parent-opt">&nbsp;&nbsp;&nbsp;'+o.label+"</option>"):a.select.append('<option value="'+o.id+'">&nbsp;&nbsp;&nbsp;'+o.label+"</option>"),void(o.children.length>0&&e.each(o.children,function(e,t){return 1==selectOptions.hideEmpty&&0==t.count?!0:void(1==selectOptions.adCounts?a.select.append('<option value="'+t.id+'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+t.label+" ("+t.count+")</option>"):a.select.append('<option value="'+t.id+'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+t.label+"</option>"))})))}))}),("transparent"==a.select.children(".ajb-parent-opt").css("backgroundColor")||"transparent"==a.select.children(".ajb-sub-parent-opt").css("backgroundColor"))&&(a.select.children(".ajb-parent-opt").css("backgroundColor","#313131"),a.select.children(".ajb-parent-opt").css("color","#FFFFFF"),a.select.children(".ajb-sub-parent-opt").css("backgroundColor","#4E4E4E"),a.select.children(".ajb-sub-parent-opt").css("color","#FFFFFF")),"undefined"!=typeof selectOptions.selectedValue&&null!=selectOptions.selectedValue&&a.select.val(selectOptions.selectedValue.split(","));break;case"double":e(selectOptions.doubleSelectId).append('<option value="">All '+selectOptions.translation+"</option>"),e(selectOptions.subSelectId).append('<option value="">All '+selectOptions.sub_translation+"</option>"),e.each(a.data,function(t,o){return 1==selectOptions.hideEmpty&&0==o.count?!0:void(1==selectOptions.adCounts?e(selectOptions.doubleSelectId).append('<option value="'+o.id+'">'+o.label+" ("+o.count+")</option>"):e(selectOptions.doubleSelectId).append('<option value="'+o.id+'">'+o.label+"</option>"))}),e(selectOptions.doubleSelectId).unbind("change"),e(selectOptions.subSelectId).unbind("change"),e(selectOptions.doubleSelectId).change(selectOptions,function(i){""!=e(i.target).val()?(e(i.data.subSelectId).empty(),a.select.val(e(i.target).val()),e.each(a.data,function(t,o){if(o.id==e(i.target).val()){if(1==i.data.hideEmpty&&0==o.count)return!0;1==i.data.adCounts?e(i.data.subSelectId).append('<option value="'+e(i.target).val()+'">All '+o.label+" Jobs ("+o.count+")</option>"):e(i.data.subSelectId).append('<option value="'+e(i.target).val()+'">All '+o.label+" Jobs</option>"),e.each(o.children,function(t,o){return 1==i.data.hideEmpty&&0==o.count?!0:void(1==i.data.adCounts?e(i.data.subSelectId).append('<option value="'+o.id+'">'+o.label+" ("+o.count+")</option>"):e(i.data.subSelectId).append('<option value="'+o.id+'">'+o.label+"</option>"))})}})):(a.select.val(""),e(i.data.subSelectId).empty(),e(i.data.subSelectId).append('<option value="">All '+i.data.sub_translation+"</option>")),e(document).trigger("adlogicJobSearch.jobAlertsWidget.selectUpdate",[o,t])}),e(selectOptions.subSelectId).change(function(i){a.select.val(e(i.target).val()),e(document).trigger("adlogicJobSearch.jobAlertsWidget.selectUpdate",[o,t])}),"undefined"!=typeof selectOptions.selectedValue&&(selectOptions.selectedValue=selectOptions.selectedValue.split(",")[0],a.select.val(selectOptions.selectedValue),e.each(selectOptions.rawcache,function(t,o){selectOptions.selectedValue==o.id&&("0"==o.parent?(e(selectOptions.doubleSelectId).val(o.id),e(selectOptions.subSelectId).empty(),e.each(a.data,function(t,a){a.id==o.id&&(1==selectOptions.adCounts?e(selectOptions.subSelectId).append('<option value="'+o.id+'">All '+a.label+" Jobs ("+a.count+")</option>"):e(selectOptions.subSelectId).append('<option value="'+o.id+'">All '+a.label+" Jobs</option>"),e.each(a.children,function(t,o){return 1==selectOptions.hideEmpty&&0==o.count?!0:void(1==selectOptions.adCounts?e(selectOptions.subSelectId).append('<option value="'+o.id+'">'+o.label+" ("+o.count+")</option>"):e(selectOptions.subSelectId).append('<option value="'+o.id+'">'+o.label+"</option>"))}))})):(e(selectOptions.subSelectId).empty(),e.each(a.data,function(t,a){a.id==o.parent&&(1==selectOptions.adCounts?e(selectOptions.subSelectId).append('<option value="'+o.id+'">All '+a.label+" Jobs ("+a.count+")</option>"):e(selectOptions.subSelectId).append('<option value="'+o.id+'">All '+a.label+" Jobs</option>"),e.each(a.children,function(t,o){return 1==selectOptions.hideEmpty&&0==o.count?!0:void(1==selectOptions.adCounts?e(selectOptions.subSelectId).append('<option value="'+o.id+'">'+o.label+" ("+o.count+")</option>"):e(selectOptions.subSelectId).append('<option value="'+o.id+'">'+o.label+"</option>"))}))}),e(selectOptions.doubleSelectId).val(o.parent),e(selectOptions.subSelectId).val(o.id)))}));break;case"flat":a.select.append('<option value="">All '+selectOptions.translation+"</option>"),e.each(a.data,function(e,t){return 1==selectOptions.hideEmpty&&0==t.count?!0:void(1==selectOptions.adCounts?a.select.append('<option value="'+t.id+'">'+t.label+" ("+t.count+")</option>"):a.select.append('<option value="'+t.id+'">'+t.label+"</option>"))}),"undefined"!=typeof selectOptions.selectedValue&&null!=selectOptions.selectedValue&&a.select.val(selectOptions.selectedValue.split(","))}a.select.prev("label").toggleClass("loading"),e(document).trigger("adlogicJobSearch.jobAlertsWidget.loaded",[o,t])},subscribe:function(){var a=e("#"+t.widgetId+"-first_name").val(),i=e("#"+t.widgetId+"-surname").val(),n=e("#"+t.widgetId+"-email_address").val(),s=e("#"+t.widgetId+"-phone_number").val(),c=e("#"+t.widgetId+"-classification_id").val(),l=e("#"+t.widgetId+"-location_id").val(),d=e("#"+t.widgetId+"-worktype_id").val(),r=e("#"+t.widgetId+"-alert_frequency").val(),p={},u=!1,b="";if(""==a?(e("#"+t.widgetId+"-first_name").addClass("adlogic_error"),u=!0,b+="- No First Name Entered\n"):(p.name=a,e("#"+t.widgetId+"-first_name").removeClass("adlogic_error")),""==i||(p.surname=i),/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(n)?(p.email=n,e("#"+t.widgetId+"-email_address").removeClass("adlogic_error")):(e("#"+t.widgetId+"-email_address").addClass("adlogic_error"),u=!0,b+="- Invalid Email Address\n"),""==s||(p.contactNumber=s),""==c||(p.indId=c),""==l||(p.locId=l),""==d||(p.wtId=d),""==r||(p.noticePeriod=r),u)alert("Please correct the job alert form errors:\n\n"+b);else{var h;h=e('<div class="adlogic_alerts_loading_div"></div>'),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").after(h),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").attr("disabled",!0),e.ajax(adlogicJobSearch.ajaxurl+"?action=subscribeJobAlerts",{data:p,type:"post",success:function(a){alert("You've successfully subscribed to the Job Alerts"),e("#"+t.widgetId+" .ajb-subscribe-job-alerts").attr("disabled",!1),h.remove(),e(document).trigger("adlogicJobSearch.jobAlertsWidget.subscribed",[e(o),a])}})}}};return this.each(function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.adlogicSearchWidget"):s.init.apply(this,arguments)})}})}(jQuery);